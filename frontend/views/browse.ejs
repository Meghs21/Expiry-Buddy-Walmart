<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ExpiryBuddy - Browse Products</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Pacifico&family=Roboto:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css"
    />
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: { primary: "#4CAF50", secondary: "#FFA726" },
            borderRadius: {
              none: "0px",
              sm: "4px",
              DEFAULT: "8px",
              md: "12px",
              lg: "16px",
              xl: "20px",
              "2xl": "24px",
              "3xl": "32px",
              full: "9999px",
              button: "8px",
            },
          },
        },
      };
    </script>
    <style>
      :where([class^="ri-"])::before { content: "\f3c2"; }
      body {
          font-family: 'Roboto', sans-serif;
          color: #333333;
          background-color: #F5F5F5;
      }
      h1, h2, h3, h4, h5, h6 {
          font-family: 'Inter', sans-serif;
      }
      .logo {
          font-family: 'Pacifico', serif;
      }
      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
          -webkit-appearance: none;
          margin: 0;
      }
      input[type="number"] {
          -moz-appearance: textfield;
      }
      .custom-checkbox {
          display: flex;
          align-items: center;
          cursor: pointer;
      }
      .custom-checkbox input {
          position: absolute;
          opacity: 0;
          cursor: pointer;
          height: 0;
          width: 0;
      }
      .checkmark {
          height: 20px;
          width: 20px;
          background-color: #fff;
          border: 2px solid #ddd;
          border-radius: 4px;
          display: flex;
          align-items: center;
          justify-content: center;
      }
      .custom-checkbox input:checked ~ .checkmark {
          background-color: #4CAF50;
          border-color: #4CAF50;
      }
      .checkmark:after {
          content: "";
          display: none;
      }
      .custom-checkbox input:checked ~ .checkmark:after {
          display: block;
          width: 5px;
          height: 10px;
          border: solid white;
          border-width: 0 2px 2px 0;
          transform: rotate(45deg);
          margin-bottom: 2px;
      }
      .custom-switch {
          position: relative;
          display: inline-block;
          width: 48px;
          height: 24px;
      }
      .custom-switch input {
          opacity: 0;
          width: 0;
          height: 0;
      }
      .switch-slider {
          position: absolute;
          cursor: pointer;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: #ccc;
          transition: .4s;
          border-radius: 24px;
      }
      .switch-slider:before {
          position: absolute;
          content: "";
          height: 18px;
          width: 18px;
          left: 3px;
          bottom: 3px;
          background-color: white;
          transition: .4s;
          border-radius: 50%;
      }
      input:checked + .switch-slider {
          background-color: #4CAF50;
      }
      input:checked + .switch-slider:before {
          transform: translateX(24px);
      }
      .custom-select {
          position: relative;
          display: inline-block;
          width: 100%;
      }
      .custom-select select {
          display: none;
      }
      .select-selected {
          background-color: white;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 10px 16px;
          cursor: pointer;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }
      .select-items {
          position: absolute;
          background-color: white;
          top: 100%;
          left: 0;
          right: 0;
          z-index: 99;
          border-radius: 8px;
          margin-top: 4px;
          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
          max-height: 250px;
          overflow-y: auto;
          display: none;
      }
      .select-items div {
          padding: 10px 16px;
          cursor: pointer;
      }
      .select-items div:hover {
          background-color: rgba(76, 175, 80, 0.1);
      }
      .select-hide {
          display: none;
      }
      .same-as-selected {
          background-color: rgba(76, 175, 80, 0.1);
      }
      .range-slider {
          width: 100%;
          height: 5px;
          background: #ddd;
          border-radius: 5px;
          position: relative;
      }
      .range-selected {
          height: 100%;
          left: 0;
          right: 0;
          position: absolute;
          border-radius: 5px;
          background: #4CAF50;
      }
      .range-input {
          position: relative;
          height: 5px;
      }
      .range-input input {
          position: absolute;
          width: 100%;
          height: 5px;
          background: none;
          pointer-events: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
      }
      .range-input input::-webkit-slider-thumb {
          height: 20px;
          width: 20px;
          border-radius: 50%;
          border: 3px solid #4CAF50;
          background: white;
          pointer-events: auto;
          -webkit-appearance: none;
          cursor: pointer;
      }
      .range-input input::-moz-range-thumb {
          height: 20px;
          width: 20px;
          border-radius: 50%;
          border: 3px solid #4CAF50;
          background: white;
          pointer-events: auto;
          -moz-appearance: none;
          cursor: pointer;
      }
      .filter-sidebar {
          transition: transform 0.3s ease;
      }
      @media (max-width: 768px) {
          .filter-sidebar {
              transform: translateX(-100%);
              position: fixed;
              top: 0;
              left: 0;
              height: 100%;
              z-index: 40;
              width: 300px;
          }
          .filter-sidebar.active {
              transform: translateX(0);
          }
          .filter-overlay {
              display: none;
              position: fixed;
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;
              background-color: rgba(0, 0, 0, 0.5);
              z-index: 30;
          }
          .filter-overlay.active {
              display: block;
          }
      }
      .user-dropdown {
          transition: all 0.3s ease;
          transform-origin: top right;
          transform: scale(0.95);
          opacity: 0;
          visibility: hidden;
      }
      .group:hover .user-dropdown {
          transform: scale(1);
          opacity: 1;
          visibility: visible;
      }
    </style>
  </head>
  <body>
    <header class="bg-white shadow-sm sticky top-0 z-50">
      <div class="container mx-auto px-4 flex items-center justify-between h-16">
        <div class="flex items-center">
          <a href="/home" class="text-primary text-2xl font-['Pacifico'] mr-8">ExpiryBuddy</a>
          <nav class="hidden md:flex space-x-6">
            <a href="/browse" class="text-primary font-medium">Browse</a>
          </nav>
        </div>
        <div class="flex-1 max-w-md mx-4 hidden md:block">
          <div class="relative">
            <input type="text" placeholder="Search products, categories, or locations..." class="w-full py-2 pl-10 pr-4 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm" />
            <div class="absolute left-3 top-2.5 w-5 h-5 flex items-center justify-center text-gray-400">
              <i class="ri-search-line"></i>
            </div>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <a href="/wishlist" class="w-10 h-10 flex items-center justify-center text-gray-600 hover:text-primary rounded-full hover:bg-gray-100 relative">
            <i class="ri-heart-line text-xl"></i>
            <% if (locals.wishlistCount && wishlistCount > 0) { %>
              <span class="absolute -top-1 -right-1 bg-primary text-white text-xs w-5 h-5 flex items-center justify-center rounded-full"><%= wishlistCount %></span>
            <% } %>
          </a>
          <a href="/cart" class="w-10 h-10 flex items-center justify-center text-gray-600 hover:text-primary rounded-full hover:bg-gray-100 relative">
            <i class="ri-shopping-cart-2-line text-xl"></i>
            <% if (locals.cartCount && cartCount > 0) { %>
              <span class="absolute -top-1 -right-1 bg-primary text-white text-xs w-5 h-5 flex items-center justify-center rounded-full"><%= cartCount %></span>
            <% } %>
          </a>
          <% if (locals.isLoggedIn && locals.user) { %>
            <div class="relative group">
              <button class="w-10 h-10 flex items-center justify-center text-gray-600 hover:text-primary rounded-full hover:bg-gray-100">
                <i class="ri-user-line text-xl"></i>
              </button>
              <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-50 user-dropdown">
                <div class="px-4 py-2 border-b border-gray-100">
                  <p class="font-medium text-gray-800"><%= user.fullName %></p>
                </div>
                <a href="/logout" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">Logout</a>
              </div>
            </div>
          <% } else { %>
            <a href="/signup" class="w-10 h-10 flex items-center justify-center text-gray-600 hover:text-primary rounded-full hover:bg-gray-100">
              <i class="ri-user-line text-xl"></i>
            </a>
          <% } %>
          <button id="mobile-menu-button" class="md:hidden w-10 h-10 flex items-center justify-center text-gray-600 hover:text-primary rounded-full hover:bg-gray-100">
            <i class="ri-menu-line text-xl"></i>
          </button>
        </div>
      </div>
      <div class="md:hidden px-4 py-2 bg-white border-t border-gray-100">
        <div class="relative">
          <input type="text" placeholder="Search..." class="w-full py-2 pl-10 pr-4 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm" />
          <div class="absolute left-3 top-2.5 w-5 h-5 flex items-center justify-center text-gray-400">
            <i class="ri-search-line"></i>
          </div>
        </div>
      </div>
    </header>

    <div class="container mx-auto px-4 py-6">
      <div class="flex items-center text-sm text-gray-600 mb-6">
        <a href="/home" class="hover:text-primary">Home</a>
        <span class="mx-2">/</span>
        <span class="text-primary font-medium">Browse Products</span>
      </div>

      <form id="filterForm" method="get" action="/browse">
      <div class="flex flex-col md:flex-row gap-6">
        <!-- Filter Sidebar -->
        <div id="filter-sidebar" class="filter-sidebar bg-white rounded-lg shadow-sm p-5 md:w-72 w-full md:sticky md:top-24 h-fit">
          <div class="flex justify-between items-center mb-6 md:hidden">
            <h3 class="font-bold text-lg">Filters</h3>
            <button id="close-filter" class="w-8 h-8 flex items-center justify-center text-gray-600 hover:text-primary rounded-full hover:bg-gray-100">
              <i class="ri-close-line text-xl"></i>
            </button>
          </div>

          <div class="mb-6">
            <h4 class="font-medium text-gray-800 mb-3">Price Range</h4>
            <div class="flex items-center justify-between mb-2">
              <span id="price-min" class="text-sm text-gray-600">₹<%= minPrice %></span>
              <span id="price-max" class="text-sm text-gray-600">₹<%= maxPrice %></span>
            </div>
            <div class="range-slider mb-4">
              <div class="range-selected" id="price-range-selected"></div>
              <div class="range-input">
                <input type="range" min="<%= minPrice %>" max="<%= maxPrice %>" value="<%= typeof query !== 'undefined' && query.priceMin ? query.priceMin : minPrice %>" class="price-min-range" name="priceMin" />
                <input type="range" min="<%= minPrice %>" max="<%= maxPrice %>" value="<%= typeof query !== 'undefined' && query.priceMax ? query.priceMax : maxPrice %>" class="price-max-range" name="priceMax" />
              </div>
            </div>
            <div class="flex items-center gap-2">
              <div class="relative flex-1">
                <input type="number" min="<%= minPrice %>" max="<%= maxPrice %>" value="<%= typeof query !== 'undefined' && query.priceMin ? query.priceMin : minPrice %>" class="w-full px-3 py-2 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm" id="price-min-input" name="priceMin" />
                <div class="absolute left-3 top-2 text-gray-500 text-sm">₹</div>
              </div>
              <span class="text-gray-400">-</span>
              <div class="relative flex-1">
                <input type="number" min="<%= minPrice %>" max="<%= maxPrice %>" value="<%= typeof query !== 'undefined' && query.priceMax ? query.priceMax : maxPrice %>" class="w-full px-3 py-2 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm" id="price-max-input" name="priceMax" />
                <div class="absolute left-3 top-2 text-gray-500 text-sm">₹</div>
              </div>
            </div>
          </div>

          <div class="mb-6">
            <h4 class="font-medium text-gray-800 mb-3">Expiry Date Range</h4>
            <div class="space-y-3">
              <div>
                <label class="block text-sm text-gray-600 mb-1">From</label>
                <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm" name="expiryFrom" value="<%= typeof query !== 'undefined' && query.expiryFrom ? query.expiryFrom : '' %>" />
              </div>
              <div>
                <label class="block text-sm text-gray-600 mb-1">To</label>
                <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm" name="expiryTo" value="<%= typeof query !== 'undefined' && query.expiryTo ? query.expiryTo : '' %>" />
              </div>
            </div>
          </div>

          <div class="mb-6">
            <h4 class="font-medium text-gray-800 mb-3">Categories</h4>
            <div class="space-y-2 max-h-48 overflow-y-auto pr-2">
              <% allCategories.forEach(cat => { %>
                <label class="custom-checkbox">
                  <input type="checkbox" name="categories" value="<%= cat %>" <%= typeof query !== 'undefined' && query.categories && (Array.isArray(query.categories) ? query.categories.includes(cat) : query.categories === cat) ? 'checked' : '' %> />
                  <span class="checkmark"></span>
                  <span class="ml-2 text-sm"><%= cat %></span>
                </label>
              <% }); %>
            </div>
          </div>

          <div class="mb-6">
            <h4 class="font-medium text-gray-800 mb-3">Store Location</h4>
            <div class="space-y-2 max-h-48 overflow-y-auto pr-2">
              <% allLocations.forEach(loc => { %>
                <label class="custom-checkbox">
                  <input type="checkbox" name="locations" value="<%= loc %>" <%= typeof query !== 'undefined' && query.locations && (Array.isArray(query.locations) ? query.locations.includes(loc) : query.locations === loc) ? 'checked' : '' %> />
                  <span class="checkmark"></span>
                  <span class="ml-2 text-sm"><%= loc %></span>
                </label>
              <% }); %>
            </div>
          </div>

          <div class="mb-6">
            <h4 class="font-medium text-gray-800 mb-3">Availability</h4>
            <div class="flex items-center justify-between">
              <span class="text-sm text-gray-600">In Stock Only</span>
              <label class="custom-switch">
                <input type="checkbox" name="inStock" value="true" <%= typeof query !== 'undefined' && query.inStock === 'true' ? 'checked' : '' %> />
                <span class="switch-slider"></span>
              </label>
            </div>
          </div>

          <div class="flex flex-col gap-3">
            <button type="submit" class="bg-primary text-white px-4 py-2 rounded-button font-medium hover:bg-green-600 transition-colors whitespace-nowrap">Apply Filters</button>
            <button type="button" onclick="window.location='/browse'" class="bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-button font-medium hover:bg-gray-50 transition-colors whitespace-nowrap">Reset Filters</button>
          </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1">
          <div class="bg-white rounded-lg shadow-sm p-5 mb-6">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4">
              <h1 class="text-2xl font-bold">Browse Products (<%= totalProducts %>)</h1>
              <div class="flex md:justify-end items-center gap-3">
                <button id="filter-button" class="md:hidden flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-button text-gray-700 hover:bg-gray-50 whitespace-nowrap">
                  <i class="ri-filter-3-line"></i>
                  <span>Filters</span>
                </button>
                <div class="custom-select w-48">
                  <select name="sortBy" onchange="document.getElementById('filterForm').submit()">
                    <option value="expiryDate" <%= typeof query !== 'undefined' && query.sortBy === 'expiryDate' ? 'selected' : '' %>>Sort by: Expiry Date</option>
                    <option value="discount" <%= typeof query !== 'undefined' && query.sortBy === 'discount' ? 'selected' : '' %>>Sort by: Discount %</option>
                    <option value="priceLowHigh" <%= typeof query !== 'undefined' && query.sortBy === 'priceLowHigh' ? 'selected' : '' %>>Sort by: Price (Low to High)</option>
                    <option value="priceHighLow" <%= typeof query !== 'undefined' && query.sortBy === 'priceHighLow' ? 'selected' : '' %>>Sort by: Price (High to Low)</option>
                  </select>
                </div>
                <div class="flex items-center gap-2">
                  <span>Show:</span>
                  <div class="custom-select w-20">
                    <select name="show" onchange="document.getElementById('filterForm').submit()">
                      <option value="16" <%= typeof query !== 'undefined' && query.show === '16' ? 'selected' : '' %>>16</option>
                      <option value="32" <%= typeof query !== 'undefined' && query.show === '32' ? 'selected' : '' %>>32</option>
                      <option value="48" <%= typeof query !== 'undefined' && query.show === '48' ? 'selected' : '' %>>48</option>
                      <option value="All" <%= typeof query !== 'undefined' && query.show === 'All' ? 'selected' : '' %>>All</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="flex items-center justify-between text-sm text-gray-600">
              <div>Showing <%= (currentPage-1)*perPage+1 %>-<%= Math.min(currentPage*perPage, totalProducts) %> of <%= totalProducts %> products</div>
            </div>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          <% products.forEach(product => { %>
            <div class="bg-white rounded-lg shadow-sm overflow-hidden transition-all hover:shadow-md">
              <div class="relative">
                <img src="<%= product.imageUrl %>" alt="<%= product.name %>" class="w-full h-48 object-cover object-top" />
                <div class="absolute top-3 right-3 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full">
                  <%= Math.ceil((new Date(product.expiryDate) - new Date()) / (1000 * 60 * 60 * 24)) %> days left
                </div>
                <div class="absolute top-3 left-3 bg-green-100 text-primary text-xs font-bold px-2 py-1 rounded-full">
                  <%= product.category %>
                </div>
              </div>
              <div class="p-4">
                <h3 class="font-bold text-lg mb-1"><%= product.name %></h3>
                <div class="flex items-center mb-2">
                  <span class="text-gray-500 line-through mr-2">₹<%= product.price %></span>
                  <span class="text-lg font-bold text-primary">₹<%= product.finalPrice || product.price %></span>
                  <% if (product.discount > 0) { %>
                    <span class="ml-2 bg-secondary text-white text-xs px-2 py-1 rounded-full"><%= product.discount %>% off</span>
                  <% } %>
                </div>
                <div class="flex items-center text-sm text-gray-600 mb-3">
                  <i class="ri-calendar-line mr-1"></i>
                  <span>Expires: <%= new Date(product.expiryDate).toLocaleDateString() %></span>
                </div>
                <div class="flex gap-2">
                  <form action="/cart/add/<%= product._id %>" method="POST" class="flex-1">
                    <button type="submit" class="w-full bg-primary text-white font-medium py-2 rounded-button hover:bg-green-600 transition-colors">Add to Cart</button>
                  </form>
                  <button onclick="toggleWishlist('<%= product._id %>', this)" class="wishlist-button w-10 h-10 flex items-center justify-center bg-white border border-primary text-primary rounded-button transition-colors <%= product.isWishlisted ? 'text-red-500' : 'text-primary' %>">
                    <i class="<%= product.isWishlisted ? 'ri-heart-fill' : 'ri-heart-line' %>"></i>
                  </button>
                </div>
              </div>
            </div>
          <% }); %>
          </div>
        </div>
      </div>
      </form>

    <div id="filter-overlay" class="filter-overlay"></div>

    <footer class="bg-gray-800 text-white pt-12 pb-6 mt-16">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
          <div>
            <h3 class="text-xl font-['Pacifico'] mb-4">ExpiryBuddy</h3>
            <p class="text-gray-400 mb-4">Helping you save money while reducing food waste in your community.</p>
            <div class="flex space-x-4">
              <a href="#" class="text-gray-400 hover:text-white"><div class="w-8 h-8 flex items-center justify-center"><i class="ri-facebook-fill"></i></div></a>
              <a href="#" class="text-gray-400 hover:text-white"><div class="w-8 h-8 flex items-center justify-center"><i class="ri-twitter-fill"></i></div></a>
              <a href="#" class="text-gray-400 hover:text-white"><div class="w-8 h-8 flex items-center justify-center"><i class="ri-instagram-fill"></i></div></a>
              <a href="#" class="text-gray-400 hover:text-white"><div class="w-8 h-8 flex items-center justify-center"><i class="ri-linkedin-fill"></i></div></a>
            </div>
          </div>
          <div>
            <h4 class="text-lg font-bold mb-4">Quick Links</h4>
            <ul class="space-y-2">
              <li><a href="https://readdy.ai/home/4e7bcec1-8bfd-493d-83c1-fcf514c9941b/09cd3cab-eb19-4a4c-9af5-15d5ab0b82c5" data-readdy="true" class="text-gray-400 hover:text-white">Home</a></li>
              <li><a href="#" class="text-gray-400 hover:text-white">Browse Products</a></li>
              <li><a href="#" class="text-gray-400 hover:text-white">Upload Products</a></li>
              <li></li>
              <li><a href="#" class="text-gray-400 hover:text-white">Our Impact</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-bold mb-4">For Users</h4>
            <ul class="space-y-2">
              <li><a href="#" class="text-gray-400 hover:text-white">How It Works</a></li>
              <li><a href="#" class="text-gray-400 hover:text-white">Create Account</a></li>
              <li><a href="#" class="text-gray-400 hover:text-white">For Retailers</a></li>
              <li><a href="#" class="text-gray-400 hover:text-white">For Shelters</a></li>
              <li><a href="#" class="text-gray-400 hover:text-white">FAQs</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-lg font-bold mb-4">Contact Us</h4>
            <ul class="space-y-2">
              <li class="flex items-center"><div class="w-5 h-5 flex items-center justify-center mr-2 text-gray-400"><i class="ri-mail-line"></i></div><a href="mailto:info@expirybuddy.com" class="text-gray-400 hover:text-white">info@expirybuddy.com</a></li>
              <li class="flex items-center"><div class="w-5 h-5 flex items-center justify-center mr-2 text-gray-400"><i class="ri-phone-line"></i></div><a href="tel:+1234567890" class="text-gray-400 hover:text-white">+1 (234) 567-890</a></li>
              <li class="flex items-center"><div class="w-5 h-5 flex items-center justify-center mr-2 text-gray-400"><i class="ri-map-pin-line"></i></div><span class="text-gray-400">123 Green Street, Anytown, USA</span></li>
            </ul>
          </div>
        </div>
        <div class="border-t border-gray-700 pt-6 flex flex-col md:flex-row justify-between items-center">
          <p class="text-gray-400 text-sm mb-4 md:mb-0">&copy; 2025 ExpiryBuddy. All rights reserved.</p>
          <div class="flex flex-wrap justify-center gap-4">
            <a href="#" class="text-gray-400 hover:text-white text-sm">Privacy Policy</a>
            <a href="#" class="text-gray-400 hover:text-white text-sm">Terms of Service</a>
            <a href="#" class="text-gray-400 hover:text-white text-sm">Cookie Policy</a>
          </div>
          <div class="flex items-center mt-4 md:mt-0">
            <div class="flex space-x-3">
              <div class="w-8 h-5 flex items-center justify-center"><i class="ri-visa-fill text-gray-400 text-xl"></i></div>
              <div class="w-8 h-5 flex items-center justify-center"><i class="ri-mastercard-fill text-gray-400 text-xl"></i></div>
              <div class="w-8 h-5 flex items-center justify-center"><i class="ri-paypal-fill text-gray-400 text-xl"></i></div>
              <div class="w-8 h-5 flex items-center justify-center"><i class="ri-apple-fill text-gray-400 text-xl"></i></div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script id="custom-select-script">
      document.addEventListener("DOMContentLoaded", function () {
        // Remove grid/list view toggle if present
        const gridListToggle = document.querySelector('.flex.items-center.border.border-gray-300.rounded-button.overflow-hidden');
        if (gridListToggle) gridListToggle.remove();
      });
    </script>
    <script id="price-range-script">
      document.addEventListener("DOMContentLoaded", function () {
        const minRange = document.querySelector(".price-min-range");
        const maxRange = document.querySelector(".price-max-range");
        const rangeSelected = document.getElementById("price-range-selected");
        const minValue = document.getElementById("price-min");
        const maxValue = document.getElementById("price-max");
        const minInput = document.getElementById("price-min-input");
        const maxInput = document.getElementById("price-max-input");

        function updateRangeValues() {
          const minVal = parseInt(minRange.value);
          const maxVal = parseInt(maxRange.value);

          if (minVal > maxVal) {
            minRange.value = maxVal;
            return;
          }

          const leftPercent = ((minVal - parseInt(minRange.min)) / (parseInt(minRange.max) - parseInt(minRange.min))) * 100;
          const rightPercent = 100 - ((maxVal - parseInt(maxRange.min)) / (parseInt(maxRange.max) - parseInt(maxRange.min))) * 100;

          rangeSelected.style.left = leftPercent + "%";
          rangeSelected.style.right = rightPercent + "%";

          minValue.textContent = "₹" + minVal;
          maxValue.textContent = "₹" + maxVal;
          minInput.value = minVal;
          maxInput.value = maxVal;
        }

        minRange.addEventListener("input", updateRangeValues);
        maxRange.addEventListener("input", updateRangeValues);

        minInput.addEventListener("input", function () {
          let val = parseInt(this.value);
          if (isNaN(val)) val = parseInt(minRange.min);
          if (val > parseInt(maxInput.value)) val = parseInt(maxInput.value);
          minRange.value = val;
          updateRangeValues();
        });

        maxInput.addEventListener("input", function () {
          let val = parseInt(this.value);
          if (isNaN(val)) val = parseInt(maxRange.max);
          if (val < parseInt(minInput.value)) val = parseInt(minInput.value);
          if (val > parseInt(maxRange.max)) val = parseInt(maxRange.max);
          maxRange.value = val;
          updateRangeValues();
        });

        updateRangeValues();
      });
    </script>
    <script id="mobile-filter-script">
      document.addEventListener("DOMContentLoaded", function () {
        const filterButton = document.getElementById("filter-button");
        const filterSidebar = document.getElementById("filter-sidebar");
        const filterOverlay = document.getElementById("filter-overlay");
        const closeFilterButton = document.getElementById("close-filter");

        if (filterButton) {
          filterButton.addEventListener("click", function () {
            filterSidebar.classList.add("active");
            filterOverlay.classList.add("active");
            document.body.style.overflow = "hidden";
          });
        }

        function closeFilter() {
          filterSidebar.classList.remove("active");
          filterOverlay.classList.remove("active");
          document.body.style.overflow = "";
        }

        if (closeFilterButton) closeFilterButton.addEventListener("click", closeFilter);
        if (filterOverlay) filterOverlay.addEventListener("click", closeFilter);
      });
    </script>
    <script id="mobile-menu-script">
      document.addEventListener("DOMContentLoaded", function () {
        const menuButton = document.getElementById("mobile-menu-button");
        if (menuButton) {
          menuButton.addEventListener("click", function () {
            const mobileMenu = document.createElement("div");
            mobileMenu.className = "fixed inset-0 bg-gray-800 bg-opacity-90 z-50 flex flex-col";
            const header = document.createElement("div");
            header.className = "flex justify-between items-center p-4 border-b border-gray-700";
            const logo = document.createElement("div");
            logo.className = "text-primary text-2xl font-['Pacifico']";
            logo.textContent = "ExpiryBuddy";
            const closeButton = document.createElement("button");
            closeButton.className = "text-white text-2xl";
            closeButton.innerHTML = '<i class="ri-close-line"></i>';
            header.appendChild(logo);
            header.appendChild(closeButton);
            const nav = document.createElement("nav");
            nav.className = "flex-1 overflow-y-auto p-4";
            const links = [
              { text: "Home", active: false, url: "https://readdy.ai/home/4e7bcec1-8bfd-493d-83c1-fcf514c9941b/09cd3cab-eb19-4a4c-9af5-15d5ab0b82c5", dataReaddy: true },
              { text: "Browse", active: true },
              { text: "Upload", active: false },
              { text: "Donations", active: false },
              { text: "How It Works", active: false },
              { text: "Our Impact", active: false },
              { text: "Contact Us", active: false },
            ];
            const ul = document.createElement("ul");
            ul.className = "space-y-4";
            links.forEach((link) => {
              const li = document.createElement("li");
              const a = document.createElement("a");
              if (link.url) {
                a.href = link.url;
                if (link.dataReaddy) {
                  a.setAttribute("data-readdy", "true");
                }
              } else {
                a.href = "#";
              }
              a.className = link.active ? "text-primary text-xl font-medium block py-2" : "text-white text-xl font-medium block py-2";
              a.textContent = link.text;
              li.appendChild(a);
              ul.appendChild(li);
            });
            nav.appendChild(ul);
            mobileMenu.appendChild(header);
            mobileMenu.appendChild(nav);
            document.body.appendChild(mobileMenu);
            document.body.style.overflow = "hidden";
            closeButton.addEventListener("click", function () {
              document.body.removeChild(mobileMenu);
              document.body.style.overflow = "";
            });
          });
        }
      });
    </script>
    <script>
      async function toggleWishlist(productId, button) {
        const icon = button.querySelector("i");
        const isWishlisted = icon.classList.contains("ri-heart-fill");
        try {
          const res = await fetch(`/wishlist/${isWishlisted ? "remove" : "add"}/${productId}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" }
          });
          if (res.ok) {
            icon.classList.toggle("ri-heart-line");
            icon.classList.toggle("ri-heart-fill");
            button.classList.toggle("text-primary");
            button.classList.toggle("text-red-500");
          } else {
            console.error(await res.text());
          }
        } catch (err) {
          console.error("Wishlist toggle failed", err);
        }
      }
    </script>
  </body>
</html>
